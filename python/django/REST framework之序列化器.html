<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>REST framework之序列化器 | 独角兕大王</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.ccac5a78.css" as="style"><link rel="preload" href="/assets/js/app.51f2f156.js" as="script"><link rel="preload" href="/assets/js/2.8911ec45.js" as="script"><link rel="preload" href="/assets/js/47.f3990404.js" as="script"><link rel="prefetch" href="/assets/js/10.6948c28b.js"><link rel="prefetch" href="/assets/js/100.276864ee.js"><link rel="prefetch" href="/assets/js/101.447ab1c7.js"><link rel="prefetch" href="/assets/js/102.f5b3c71d.js"><link rel="prefetch" href="/assets/js/103.16474d4b.js"><link rel="prefetch" href="/assets/js/104.ed58aef3.js"><link rel="prefetch" href="/assets/js/105.045203cd.js"><link rel="prefetch" href="/assets/js/106.be359e0b.js"><link rel="prefetch" href="/assets/js/107.7331bbca.js"><link rel="prefetch" href="/assets/js/108.76e1c800.js"><link rel="prefetch" href="/assets/js/109.e82166f3.js"><link rel="prefetch" href="/assets/js/11.d4ec37c8.js"><link rel="prefetch" href="/assets/js/110.4144755a.js"><link rel="prefetch" href="/assets/js/111.5864ab53.js"><link rel="prefetch" href="/assets/js/112.ca2aee84.js"><link rel="prefetch" href="/assets/js/113.641e7765.js"><link rel="prefetch" href="/assets/js/114.d69f8545.js"><link rel="prefetch" href="/assets/js/115.1b6a9f89.js"><link rel="prefetch" href="/assets/js/116.dde2c44e.js"><link rel="prefetch" href="/assets/js/117.4e79498c.js"><link rel="prefetch" href="/assets/js/12.7aac9c8d.js"><link rel="prefetch" href="/assets/js/13.abf127cd.js"><link rel="prefetch" href="/assets/js/14.aa4413a7.js"><link rel="prefetch" href="/assets/js/15.11a64e5b.js"><link rel="prefetch" href="/assets/js/16.f2d9a882.js"><link rel="prefetch" href="/assets/js/17.11c5bb7f.js"><link rel="prefetch" href="/assets/js/18.a522877b.js"><link rel="prefetch" href="/assets/js/19.6f31a972.js"><link rel="prefetch" href="/assets/js/20.b546c54e.js"><link rel="prefetch" href="/assets/js/21.6d055b7f.js"><link rel="prefetch" href="/assets/js/22.c48feceb.js"><link rel="prefetch" href="/assets/js/23.69941f78.js"><link rel="prefetch" href="/assets/js/24.6126dfc2.js"><link rel="prefetch" href="/assets/js/25.3475449c.js"><link rel="prefetch" href="/assets/js/26.96bb4643.js"><link rel="prefetch" href="/assets/js/27.da610e5d.js"><link rel="prefetch" href="/assets/js/28.b24ec15c.js"><link rel="prefetch" href="/assets/js/29.ec8af553.js"><link rel="prefetch" href="/assets/js/3.bec5f768.js"><link rel="prefetch" href="/assets/js/30.2e780db1.js"><link rel="prefetch" href="/assets/js/31.464c36ed.js"><link rel="prefetch" href="/assets/js/32.ad7d37c2.js"><link rel="prefetch" href="/assets/js/33.722f1ec5.js"><link rel="prefetch" href="/assets/js/34.8448d0fd.js"><link rel="prefetch" href="/assets/js/35.e5168ac9.js"><link rel="prefetch" href="/assets/js/36.edc404f1.js"><link rel="prefetch" href="/assets/js/37.5807602e.js"><link rel="prefetch" href="/assets/js/38.a519c89a.js"><link rel="prefetch" href="/assets/js/39.89af1b9a.js"><link rel="prefetch" href="/assets/js/4.5ed19beb.js"><link rel="prefetch" href="/assets/js/40.6c653db9.js"><link rel="prefetch" href="/assets/js/41.bc3b8b69.js"><link rel="prefetch" href="/assets/js/42.a0a02d9b.js"><link rel="prefetch" href="/assets/js/43.62f344e3.js"><link rel="prefetch" href="/assets/js/44.a7fd9d68.js"><link rel="prefetch" href="/assets/js/45.729c1c39.js"><link rel="prefetch" href="/assets/js/46.5b924aea.js"><link rel="prefetch" href="/assets/js/48.f591f360.js"><link rel="prefetch" href="/assets/js/49.f7f213ad.js"><link rel="prefetch" href="/assets/js/5.2c5d28b5.js"><link rel="prefetch" href="/assets/js/50.b9ca2762.js"><link rel="prefetch" href="/assets/js/51.93672ee6.js"><link rel="prefetch" href="/assets/js/52.fb21314a.js"><link rel="prefetch" href="/assets/js/53.65343ccc.js"><link rel="prefetch" href="/assets/js/54.8081227d.js"><link rel="prefetch" href="/assets/js/55.e207659e.js"><link rel="prefetch" href="/assets/js/56.bde381df.js"><link rel="prefetch" href="/assets/js/57.f8eceb45.js"><link rel="prefetch" href="/assets/js/58.bef70bfd.js"><link rel="prefetch" href="/assets/js/59.7ab7562d.js"><link rel="prefetch" href="/assets/js/6.fc65a1ac.js"><link rel="prefetch" href="/assets/js/60.f40ac3ca.js"><link rel="prefetch" href="/assets/js/61.d2b463ab.js"><link rel="prefetch" href="/assets/js/62.cfdf1bcf.js"><link rel="prefetch" href="/assets/js/63.1e45ce59.js"><link rel="prefetch" href="/assets/js/64.a98fe86e.js"><link rel="prefetch" href="/assets/js/65.0234d7c5.js"><link rel="prefetch" href="/assets/js/66.724906f0.js"><link rel="prefetch" href="/assets/js/67.7806fda6.js"><link rel="prefetch" href="/assets/js/68.9f227dae.js"><link rel="prefetch" href="/assets/js/69.fdbc56ac.js"><link rel="prefetch" href="/assets/js/7.284de54e.js"><link rel="prefetch" href="/assets/js/70.04a9cc03.js"><link rel="prefetch" href="/assets/js/71.a6fa1dd9.js"><link rel="prefetch" href="/assets/js/72.2f8e3aa0.js"><link rel="prefetch" href="/assets/js/73.9bbb0cb6.js"><link rel="prefetch" href="/assets/js/74.9f122255.js"><link rel="prefetch" href="/assets/js/75.75e1fbd8.js"><link rel="prefetch" href="/assets/js/76.60ff3c3e.js"><link rel="prefetch" href="/assets/js/77.39a253ae.js"><link rel="prefetch" href="/assets/js/78.0e49712f.js"><link rel="prefetch" href="/assets/js/79.5f9c24a0.js"><link rel="prefetch" href="/assets/js/8.5c21a4cc.js"><link rel="prefetch" href="/assets/js/80.f826f188.js"><link rel="prefetch" href="/assets/js/81.b8995ea7.js"><link rel="prefetch" href="/assets/js/82.e9bf63e0.js"><link rel="prefetch" href="/assets/js/83.e3a00749.js"><link rel="prefetch" href="/assets/js/84.b940927c.js"><link rel="prefetch" href="/assets/js/85.ad46a9b2.js"><link rel="prefetch" href="/assets/js/86.190e0071.js"><link rel="prefetch" href="/assets/js/87.5f9eb9ef.js"><link rel="prefetch" href="/assets/js/88.cfaf7469.js"><link rel="prefetch" href="/assets/js/89.e64cc32c.js"><link rel="prefetch" href="/assets/js/9.0723805d.js"><link rel="prefetch" href="/assets/js/90.805edabe.js"><link rel="prefetch" href="/assets/js/91.6a1ab3f7.js"><link rel="prefetch" href="/assets/js/92.04ecd01e.js"><link rel="prefetch" href="/assets/js/93.e615470a.js"><link rel="prefetch" href="/assets/js/94.0ad7c41c.js"><link rel="prefetch" href="/assets/js/95.0e5ce618.js"><link rel="prefetch" href="/assets/js/96.b59cf9f4.js"><link rel="prefetch" href="/assets/js/97.2a327746.js"><link rel="prefetch" href="/assets/js/98.9c01ec88.js"><link rel="prefetch" href="/assets/js/99.952046bd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccac5a78.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://github.com/fluidicon.png" alt="独角兕大王" class="logo"> <span class="site-name can-hide">独角兕大王</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/python/" class="nav-link router-link-active">
  Python
</a></div><div class="nav-item"><a href="/rust/" class="nav-link">
  Rust
</a></div><div class="nav-item"><a href="/go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/lua/" class="nav-link">
  Lua
</a></div><div class="nav-item"><a href="/C/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="https://github.com/wuyuz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.cnblogs.com/double-W/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cnblogs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/python/" class="nav-link router-link-active">
  Python
</a></div><div class="nav-item"><a href="/rust/" class="nav-link">
  Rust
</a></div><div class="nav-item"><a href="/go/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/java/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/lua/" class="nav-link">
  Lua
</a></div><div class="nav-item"><a href="/C/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="https://github.com/wuyuz" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.cnblogs.com/double-W/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  cnblogs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python常用模块</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Django框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/python/django/Web框架本质.html" class="sidebar-link">Web框架本质</a></li><li><a href="/python/django/resquest、模块层.html" class="sidebar-link">resquest、模块层</a></li><li><a href="/python/django/静态文件和ORM.html" class="sidebar-link">静态文件和ORM</a></li><li><a href="/python/django/标签、自定义标签.html" class="sidebar-link">模块层之标签、自定义标签</a></li><li><a href="/python/django/模版语法.html" class="sidebar-link">模版语法</a></li><li><a href="/python/django/模型层.html" class="sidebar-link">模型层</a></li><li><a href="/python/django/反向解析和视图函数.html" class="sidebar-link">反向解析和视图函数</a></li><li><a href="/python/django/单表操作.html" class="sidebar-link">单表操作</a></li><li><a href="/python/django/多表操作.html" class="sidebar-link">多表操作</a></li><li><a href="/python/django/中间件.html" class="sidebar-link">中间件</a></li><li><a href="/python/django/模型进阶.html" class="sidebar-link">模型进阶</a></li><li><a href="/python/django/缓存和信号.html" class="sidebar-link">缓存和信号</a></li><li><a href="/python/django/form组件.html" class="sidebar-link">form组件</a></li><li><a href="/python/django/csrf和Ajax.html" class="sidebar-link">csrf和Ajax</a></li><li><a href="/python/django/APIView使用和源码分析.html" class="sidebar-link">APIView使用和源码分析</a></li><li><a href="/python/django/REST framework之版本和解析器.html" class="sidebar-link">REST framework之版本和解析器</a></li><li><a href="/python/django/REST framework之分页和视图组件.html" class="sidebar-link">REST framework之分页和视图组件</a></li><li><a href="/python/django/REST framework之路由和渲染器.html" class="sidebar-link">REST framework之路由和渲染器</a></li><li><a href="/python/django/REST framework之序列化器.html" class="active sidebar-link">REST framework之序列化器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/python/django/REST framework之序列化器.html#rest-framework之序列化器" class="sidebar-link">REST framework之序列化器</a></li></ul></li><li><a href="/python/django/REST framework版本图书管理系统.html" class="sidebar-link">REST framework版本图书管理系统</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Flask 框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python爬虫</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python设计模式</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="rest-framework之序列化器"><a href="#rest-framework之序列化器" class="header-anchor">#</a> REST framework之序列化器</h2> <ul><li><p>创建models.py表结构</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models

<span class="token keyword">class</span> <span class="token class-name">UserGroup</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user_type_choices <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'普通用户'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'VIP'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'SVIP'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    user_type <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>user_type_choices<span class="token punctuation">)</span>
    username <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>
    
    group <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">'UserGroup'</span><span class="token punctuation">)</span>  <span class="token comment"># 一对多</span>
    roles <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span><span class="token string">'Role'</span><span class="token punctuation">)</span>  <span class="token comment"># 多对多</span>


<span class="token keyword">class</span> <span class="token class-name">UserToken</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 用户储存用户的token</span>
    user <span class="token operator">=</span> models<span class="token punctuation">.</span>OneToOneField<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">'UserInfo'</span><span class="token punctuation">)</span>
    token <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Role</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>
 
 <span class="token comment"># 执行数据库迁移，并进行填充数据</span>
</code></pre></div></li></ul> <h3 id="查询数据"><a href="#查询数据" class="header-anchor">#</a> 查询数据</h3> <h5 id="使用原有的方法取出modles中的数据-并进行返回"><a href="#使用原有的方法取出modles中的数据-并进行返回" class="header-anchor">#</a> 使用原有的方法取出modles中的数据，并进行返回</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> models
<span class="token keyword">import</span> json
<span class="token keyword">class</span> <span class="token class-name">RoleView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 全局以配置了解析器</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    
        roles <span class="token operator">=</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>roles<span class="token punctuation">)</span>  <span class="token comment"># 报错，因为json只能序列化python的数据类型，QuerySet是Django的数据类型</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
 <span class="token comment">#解决方案：</span>
<span class="token keyword">class</span> <span class="token class-name">RoleView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 全局以配置了解析器</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    
        roles <span class="token operator">=</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">)</span>
        roles <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>roles<span class="token punctuation">)</span>  <span class="token comment"># 因为这里的values取出来的还是Queryset装的字典</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>roles<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>   <span class="token comment"># 通过这个参数可以防止传入的字符串进行ascii编码</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
        
</code></pre></div><h5 id="_1、使用restframework来取数据-对queryset列表进行序列化-多个使用many-true"><a href="#_1、使用restframework来取数据-对queryset列表进行序列化-多个使用many-true" class="header-anchor">#</a> 1、使用RESTframework来取数据（对Queryset列表进行序列化，多个使用many=True）</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> models
<span class="token keyword">import</span> json
<span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers

<span class="token keyword">class</span> <span class="token class-name">RoleSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># title必须和models中的字段进行对应</span>

<span class="token keyword">class</span> <span class="token class-name">RoleView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 全局以配置了解析器</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        
        roles <span class="token operator">=</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> RoleSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>roles<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># many表示传入的数据有多条</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># ser.data 表示从数据库中查出的对象role进行了Roleseralizer序列化后的字典</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token comment">#[{&quot;id&quot;: 1, &quot;title&quot;: &quot;医生&quot;}, {&quot;id&quot;: 2, &quot;title&quot;: &quot;学生&quot;}]</span>
 
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token comment"># url.py文件中</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/users/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>UsersView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">'uuu'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/parser/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>ParserView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/roles/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>RoleView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li><p><strong>小提示：</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>  <span class="token number">1</span>、 roles <span class="token operator">=</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'医生'</span><span class="token punctuation">)</span>  <span class="token comment"># 当针对Queryset类型时必须配置many=True，即使只有一个对象</span>
  <span class="token number">2</span>、 也就是说我们要取数据的时候，必须先写一个序列化类，字段要和相对应的models中的字段像对象，没有强硬的要求（在查询的时候）
</code></pre></div></li></ul> <h5 id="_2、对单独的表对象进行取数据-序列化单个对象时many-false"><a href="#_2、对单独的表对象进行取数据-序列化单个对象时many-false" class="header-anchor">#</a> 2、对单独的表对象进行取数据（序列化单个对象时many=False)</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">RoleSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># title必须和models中的字段进行对应</span>

<span class="token keyword">class</span> <span class="token class-name">RoleView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 全局以配置了解析器</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span><span class="token operator">*</span>args<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>       
        roles <span class="token operator">=</span> models<span class="token punctuation">.</span>Role<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> RoleSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>roles<span class="token punctuation">,</span>many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># many表示传入的数据有多条</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># ser.data 表示从数据库中查出的对象role进行了Roleseralizer序列化后的有序字典</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>  <span class="token comment">#{&quot;id&quot;: 1, &quot;title&quot;: &quot;医生&quot;}</span>
</code></pre></div><h5 id="_3、处理字段中含有choices选项显示对应的值"><a href="#_3、处理字段中含有choices选项显示对应的值" class="header-anchor">#</a> 3、处理字段中含有choices选项显示对应的值</h5> <ul><li><p>原始状态我们可以取出的字段是数据库中储存的值，如下：我们想得到对应得值</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>  <span class="token comment"># 配置source来字段字段，之后就可以任意该名</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment">#[OrderedDict([('username', '序号话'), ('password', '123')]), OrderedDict([('username', '民人接'), ('password', '123')])]</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
        
  <span class="token comment"># [OrderedDict([('xxxx', '1'), ('username', '序号话'), ('password', '123')]), OrderedDict([('xxxx', '2'), ('username', '民人接'), ('password', '123')])]</span>
</code></pre></div><ul><li><p><strong>小提示：</strong></p> <div class="language- extra-class"><pre class="language-text"><code> 	之前我们说每个字段必须想对应models表中得每个字段，那是因为没有配置source选项，配置了后就可以重写自己得字段名了
</code></pre></div></li></ul></li> <li><p><strong>方案一</strong>：通过source配置相应字段得处理方式（source='get_字段_display'）</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span>  <span class="token comment"># 相似于models中的get_字段_display,取出相应字段名后调用get方法</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
   <span class="token comment"># [{&quot;xxxx&quot;: &quot;1&quot;, &quot;ooo&quot;: &quot;普通用户&quot;, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;}, {&quot;xxxx&quot;: &quot;2&quot;, &quot;ooo&quot;: &quot;VIP&quot;, &quot;username&quot;: &quot;民人接&quot;,&quot;password&quot;: &quot;123&quot;}]</span>
</code></pre></div></li></ul> <h5 id="_4、处理关系管理字段-一对多"><a href="#_4、处理关系管理字段-一对多" class="header-anchor">#</a> 4、处理关系管理字段（一对多）</h5> <ul><li><p><strong>方案一：</strong></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span>  <span class="token comment"># 相似于models中的get_字段_display,取出相应字段名后调用get方法</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    gp <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group.title'</span><span class="token punctuation">)</span> <span class="token comment"># 通过点来获取值</span>
    gp1 <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">)</span>
    
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
        
 <span class="token comment">#[{&quot;xxxx&quot;: &quot;1&quot;, &quot;ooo&quot;: &quot;普通用户&quot;, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;gp&quot;: &quot;A组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;}, {&quot;xxxx&quot;:&quot;2&quot;, &quot;ooo&quot;: &quot;VIP&quot;, &quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;: &quot;123&quot;, &quot;gp&quot;: &quot;B组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;}]  </span>
</code></pre></div><p>​</p></li></ul> <h5 id="_5、处理多对多字段时"><a href="#_5、处理多对多字段时" class="header-anchor">#</a> 5、处理多对多字段时</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span>  <span class="token comment"># 相似于models中的get_字段_display,取出相应字段名后调用get方法</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    gp <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group.title'</span><span class="token punctuation">)</span> <span class="token comment"># 通过点来获取值</span>
    gp1 <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">)</span>
    
    rls <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'roles.all'</span><span class="token punctuation">)</span>  <span class="token comment"># 多对多时，反向点all，返回的时Queryset列表，里面都都是对象</span>
    
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
   <span class="token comment"># [{&quot;xxxx&quot;: &quot;1&quot;, &quot;ooo&quot;: &quot;普通用户&quot;, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;gp&quot;: &quot;A组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;, &quot;rls&quot;: &quot;&lt;QuerySet [&lt;Role: Role object&gt;, &lt;Role: Role object&gt;]&gt;&quot;}, {&quot;xxxx&quot;: &quot;2&quot;, &quot;ooo&quot;: &quot;VIP&quot;, &quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;:&quot;123&quot;, &quot;gp&quot;: &quot;B组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;, &quot;rls&quot;: &quot;&lt;QuerySet [&lt;Role: Role object&gt;]&gt;&quot;}]</span>
</code></pre></div><ul><li><p><strong>小提示：</strong></p> <div class="language- extra-class"><pre class="language-text"><code>1、通过source配置相应得字段，可以解决一对多（正向，一对一）和choices字段去值得问题，但是涉及到多对多时，就不能做到更详细得处理了，只能返回对象
2、.all方法，只适用于关系管理对象字段上
</code></pre></div></li> <li><h5 id="更细力度得获取到多对多中-每个被关联对象得字段-通过serializermethodfield"><a href="#更细力度得获取到多对多中-每个被关联对象得字段-通过serializermethodfield" class="header-anchor">#</a> 更细力度得获取到多对多中，每个被关联对象得字段（通过SerializerMethodField)</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> rest_framework <span class="token keyword">import</span> serializers
<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span>  <span class="token comment"># 相似于models中的get_字段_display,取出相应字段名后调用get方法</span>
    username <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    gp <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group.title'</span><span class="token punctuation">)</span> <span class="token comment"># 通过点来获取值</span>
    gp1 <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># rls = serializers.CharField(source='roles.all')  # 多对多时，反向点all，返回的时Queryset列表，里面都都是对象</span>
    rls <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SerializerMethodField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自定义函数获取字段</span>
    
    <span class="token keyword">def</span> <span class="token function">get_rls</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 自定义函数</span>
        role_obj_list <span class="token operator">=</span> row<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> role_obj_list<span class="token punctuation">:</span>
            ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> ret
    
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
    <span class="token comment">#[{&quot;xxxx&quot;: &quot;1&quot;, &quot;ooo&quot;: &quot;普通用户&quot;, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;gp&quot;: &quot;A组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;, &quot;rls&quot;:[{&quot;id&quot;: 1, &quot;title&quot;: &quot;医生&quot;}, {&quot;id&quot;: 2, &quot;title&quot;: &quot;学生&quot;}]}, {&quot;xxxx&quot;: &quot;2&quot;, &quot;ooo&quot;: &quot;VIP&quot;, &quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;: &quot;123&quot;,&quot;gp&quot;: &quot;B组&quot;, &quot;gp1&quot;: &quot;UserGroup object&quot;, &quot;rls&quot;: [{&quot;id&quot;: 3, &quot;title&quot;: &quot;元昊&quot;}]}]</span>
</code></pre></div></li> <li><h5 id="通过多张表处理一对多字段-多对多不行"><a href="#通过多张表处理一对多字段-多对多不行" class="header-anchor">#</a> 通过多张表处理一对多字段（多对多不行）</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Group1Serializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    group <span class="token operator">=</span> Group1Serializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        <span class="token comment"># fields = '__all__'</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'group'</span><span class="token punctuation">,</span> <span class="token string">'roles'</span><span class="token punctuation">]</span>
</code></pre></div></li></ul> <h4 id="万金油-modelserializer"><a href="#万金油-modelserializer" class="header-anchor">#</a> 万金油：ModelSerializer</h4> <ul><li><h5 id="除了上面通过写继承serializer的类来取数据-我们还可以使用modelserializer来取数据-和我们的modelform很类似"><a href="#除了上面通过写继承serializer的类来取数据-我们还可以使用modelserializer来取数据-和我们的modelform很类似" class="header-anchor">#</a> 除了上面通过写继承Serializer的类来取数据，我们还可以使用ModelSerializer来取数据，和我们的ModelForm很类似</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo   <span class="token comment"># 选择那一张表</span>
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>  <span class="token comment"># 取出所有字段，当然也可以使用列表['id','title'...]</span>
          
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
   
 <span class="token comment"># [{&quot;id&quot;: 1, &quot;user_type&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group&quot;: 1, &quot;roles&quot;: [1, 2]}, {&quot;id&quot;: 2, &quot;user_type&quot;: 2,&quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group&quot;: 2, &quot;roles&quot;: [3]}]</span>
</code></pre></div></li> <li><h5 id="方案一-fields结合source解决一对多和choices问题"><a href="#方案一-fields结合source解决一对多和choices问题" class="header-anchor">#</a> 方案一：fields结合source解决一对多和choices问题</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span> <span class="token comment"># 结合source自定义字段</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'ooo'</span><span class="token punctuation">]</span>  <span class="token comment"># 引入多对多字段</span>
            
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
    <span class="token comment"># [{&quot;id&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;ooo&quot;: &quot;普通用户&quot;}, {&quot;id&quot;: 2, &quot;username&quot;: &quot;民人接&quot;, &quot;ooo&quot;: &quot;VIP&quot;}]</span>
</code></pre></div></li> <li><h5 id="方案二-通过serializermethodfield-解决多对多问题"><a href="#方案二-通过serializermethodfield-解决多对多问题" class="header-anchor">#</a> **方案二：**通过SerializerMethodField()解决多对多问题</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ooo <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'get_user_type_display'</span><span class="token punctuation">)</span> <span class="token comment"># 结合source自定义字段</span>
    rls <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SerializerMethodField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 自定义显示格式</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'ooo'</span><span class="token punctuation">,</span><span class="token string">'rls'</span><span class="token punctuation">]</span>  <span class="token comment"># 引入多对多字段</span>
        
    <span class="token keyword">def</span> <span class="token function">get_rls</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> row<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># row就是拿到的一条数据，一个对象</span>
        role_obj_list <span class="token operator">=</span> row<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> role_obj_list<span class="token punctuation">:</span>
            ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token string">'tile'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> ret
    
  <span class="token comment"># [{&quot;id&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;ooo&quot;: &quot;普通用户&quot;, &quot;rls&quot;: [{&quot;id&quot;: 1, &quot;tile&quot;: &quot;医生&quot;}, {&quot;id&quot;: 2, &quot;tile&quot;: &quot;学生&quot;}]}, {&quot;id&quot;: 2,&quot;username&quot;: &quot;民人接&quot;, &quot;ooo&quot;: &quot;VIP&quot;, &quot;rls&quot;: [{&quot;id&quot;: 3, &quot;tile&quot;: &quot;元昊&quot;}]}]      </span>
</code></pre></div><ul><li><p><strong>小提示</strong>：</p> <div class="language- extra-class"><pre class="language-text"><code>点开ModelSerializer，源码的第一段就是一张map表，标识了数据库中的各自字段所对应的在ModelSerualizer的字段
</code></pre></div></li></ul></li> <li><p>**方案三：**自定义类</p> <div class="language-python extra-class"><pre class="language-python"><code> <span class="token comment"># 解决choices问题</span>
<span class="token keyword">class</span> <span class="token class-name">MyField</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">to_representation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># value相当于我们取得某个字段</span>
        <span class="token keyword">return</span> value<span class="token punctuation">.</span>title

<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    xl <span class="token operator">=</span> MyField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group'</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'xl'</span><span class="token punctuation">]</span>  <span class="token comment"># 引入多对多字段</span>
 <span class="token comment"># [{&quot;id&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;xl&quot;: &quot;A组&quot;}, {&quot;id&quot;: 2, &quot;username&quot;: &quot;民人接&quot;, &quot;xl&quot;: &quot;B组&quot;}]</span>

 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>、
 <span class="token comment"># 解决多对多问题</span>
<span class="token keyword">class</span> <span class="token class-name">MyField</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">to_representation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>  <span class="token comment"># 当然我们可以再写一个serilizer序列化类，鸡肋</span>
        <span class="token keyword">return</span> ret

<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ooo = serializers.CharField(source='get_user_type_display') # 结合source自定义字段</span>
    <span class="token comment"># rls = serializers.SerializerMethodField()  # 自定义显示格式</span>
    xl <span class="token operator">=</span> MyField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'roles'</span><span class="token punctuation">)</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">,</span><span class="token string">'xl'</span><span class="token punctuation">]</span>  <span class="token comment"># 引入多对多字段</span>

</code></pre></div></li> <li><p>自定义字段来进行多对多的查询</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    country <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Country<span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token decorator annotation punctuation">@property</span>
    <span class="token keyword">def</span> <span class="token function">country_area</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>country<span class="token punctuation">.</span>area
 
 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token comment"># 在序列化类中使用</span>
<span class="token keyword">class</span> <span class="token class-name">AnimalSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pk <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    name <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    <span class="token builtin">type</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    country <span class="token operator">=</span> serializers<span class="token punctuation">.</span>PrimaryKeyRelatedField<span class="token punctuation">(</span>read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    country_area <span class="token operator">=</span> serializers<span class="token punctuation">.</span>FloatField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> source<span class="token operator">=</span>'country_area’<span class="token punctuation">)</span>
</code></pre></div></li></ul> <h5 id="部分总结"><a href="#部分总结" class="header-anchor">#</a> 部分总结</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token number">1</span>、写类
	<span class="token number">1.1</span>、继承Serializer
		<span class="token keyword">class</span> <span class="token class-name">RoleSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token builtin">id</span> <span class="token operator">=</span> serializers<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>
            title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># title必须和models中的字段进行对应</span>
   	<span class="token number">1.2</span>、继承ModelSerializer
   		<span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
                model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
                fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">]</span>  <span class="token comment"># '__all__'</span>
                
<span class="token number">2</span>、自定义字段
	<span class="token number">2.1</span>、通过source：
		 a<span class="token punctuation">.</span> choices字段：xxxx <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'user_type'</span><span class="token punctuation">)</span>
		 b<span class="token punctuation">.</span> 一对多：gp <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token string">'group.title'</span><span class="token punctuation">)</span>
		 
	<span class="token number">2.2</span>、通过SerializerMethodField<span class="token punctuation">(</span><span class="token punctuation">)</span>和自定义函数
		<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
		<span class="token keyword">def</span> <span class="token function">get_rls</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 自定义函数，get_字段， row就是整张表</span>
            role_obj_list <span class="token operator">=</span> row<span class="token punctuation">.</span>roles<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            ret <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> role_obj_list<span class="token punctuation">:</span>
                ret<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'id'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">,</span><span class="token string">'title'</span><span class="token punctuation">:</span>item<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> ret
        
    <span class="token number">2.3</span>、自定义类
</code></pre></div><h5 id="继续学习modelserializer-深度控制"><a href="#继续学习modelserializer-深度控制" class="header-anchor">#</a> 继续学习ModelSerializer：深度控制</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
        depth <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 没写这之前，我们得到的数据都是如group，roles这种涉及到一对多和多对多的字段都是取到的pk，这之后就可以获得多个每个关联对象的所有字段</span>
           
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span> 
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
   
 <span class="token comment"># 所有结构</span>
    <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;user_type&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;序号话&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;group&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;A组&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;roles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;医生&quot;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;学生&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">&quot;user_type&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;民人接&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;group&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;B组&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">&quot;roles&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                <span class="token string">&quot;title&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;元昊&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><ul><li><h5 id="小提示"><a href="#小提示" class="header-anchor">#</a> 小提示</h5> <div class="language- extra-class"><pre class="language-text"><code>1、depth 表示该表中如果都关系管理对象，就打开该对象的所有字段，表示深度，还可以depth=2
2、官方建议depth=[0~10]
</code></pre></div></li></ul> <h4 id="序列化时外键生成hyperlink"><a href="#序列化时外键生成hyperlink" class="header-anchor">#</a> 序列化时外键生成hyperlink</h4> <ul><li><h5 id="通过hyperlinkedidentityfield重写外键管理对象字段-生成动态url-必须关联一个对象"><a href="#通过hyperlinkedidentityfield重写外键管理对象字段-生成动态url-必须关联一个对象" class="header-anchor">#</a> 通过<code>HyperlinkedIdentityField</code>重写外键管理对象字段，生成动态url（必须关联一个对象）</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    group <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'gp'</span><span class="token punctuation">)</span>  <span class="token comment"># 重写group，通过url别名生成路径,必须写别名，我们的url中的pk，系统默认也是取group中的pk，如果换个名字就报错了</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        <span class="token comment"># fields = '__all__'</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'group'</span><span class="token punctuation">,</span> <span class="token string">'roles'</span><span class="token punctuation">]</span>
        depth <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment">#  默认为0</span>
        
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>   
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'request'</span><span class="token punctuation">:</span>request<span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># 需要写context</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
    
<span class="token keyword">class</span> <span class="token class-name">GourpSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserGroup
        fields <span class="token operator">=</span> <span class="token string">'__all__'</span>
    
<span class="token keyword">class</span> <span class="token class-name">GourpView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 对每个组进行详细生成url</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
         pk <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'pk'</span><span class="token punctuation">)</span>  <span class="token comment"># 通过路径传入</span>
        obj <span class="token operator">=</span> models<span class="token punctuation">.</span>UserGroup<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span>pk<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> GourpSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>obj<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
 <span class="token comment"># url.py文件中</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/userinfo/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>UserinfoView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/group/(?P&lt;pk&gt;\d+)/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>GourpView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>name <span class="token operator">=</span> <span class="token string">'gp'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

 <span class="token comment">#[{&quot;id&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group&quot;: &quot;http://127.0.0.1:8000/api/v1/group/1/&quot;, &quot;roles&quot;: [1, 2]},{&quot;id&quot;: 2, &quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group&quot;: &quot;http://127.0.0.1:8000/api/v1/group/2/&quot;, &quot;roles&quot;: [3]}]</span>
</code></pre></div><ul><li><h5 id="小提示-2"><a href="#小提示-2" class="header-anchor">#</a> 小提示：</h5> <div class="language- extra-class"><pre class="language-text"><code>1、我们url中有一个pk参数，通过HyperlinkedIdentityField字段后面的别名参数生成url时，需要参数pk，默认是一当前user.pk传入的，显然不符合我们的要求，我们的group中只有两个组，用户只继承A组
2、对每一条数据进行序列化的时候，需要添加 ser = UserInfoSerializer(instance=users, many=True,context={'request':request})的context参数
</code></pre></div></li></ul></li> <li><h5 id="升级版-修正url中的pk不对齐问题"><a href="#升级版-修正url中的pk不对齐问题" class="header-anchor">#</a> 升级版，修正url中的pk不对齐问题</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    group <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'gp'</span><span class="token punctuation">,</span>   <span class="token comment"># 指定url别名</span>
                                                 lookup_field<span class="token operator">=</span><span class="token string">'group_id'</span><span class="token punctuation">,</span> <span class="token comment"># 指定查找字段，可能是以他为参数，不能是group(对象)</span>
                                                 lookup_url_kwarg<span class="token operator">=</span><span class="token string">'pk'</span><span class="token punctuation">)</span>  <span class="token comment"># 指定参数名</span>
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        <span class="token comment"># fields = '__all__'</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'group'</span><span class="token punctuation">,</span> <span class="token string">'roles'</span><span class="token punctuation">]</span>
        depth <span class="token operator">=</span> <span class="token number">0</span>
        
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
   
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'request'</span><span class="token punctuation">:</span>request<span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># 需要写context</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
  <span class="token comment"># [{&quot;id&quot;: 1, &quot;username&quot;: &quot;序号话&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group1&quot;:&quot;http://127.0.0.1:8000/api/v1/group/1/&quot;, &quot;roles&quot;: [1, 2]}, {&quot;id&quot;: 2, &quot;username&quot;: &quot;民人接&quot;, &quot;password&quot;: &quot;123&quot;, &quot;group1&quot;: &quot;http://127.0.0.1:8000/api/v1/group/2/&quot;, &quot;roles&quot;: [3]}]</span>
</code></pre></div><ul><li><h5 id="小提示-3"><a href="#小提示-3" class="header-anchor">#</a> 小提示：</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token number">1</span>、在序列化类中定义group1字段，其以group<span class="token punctuation">.</span><span class="token builtin">id</span>作为url中的参数出入别名为<span class="token string">'gp'</span>的url中，再生成json返回数据
	group1 <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'gp'</span><span class="token punctuation">,</span>source<span class="token operator">=</span><span class="token string">'group.id'</span><span class="token punctuation">)</span>
    
<span class="token number">2</span>、源码中再HyperlinkedIdentityField中第一句：
	look_up <span class="token operator">=</span> <span class="token string">'pk'</span>  <span class="token comment"># 表示默认以pk字段为参数传入</span>
	view_name <span class="token operator">=</span> <span class="token boolean">None</span>
</code></pre></div></li></ul></li></ul> <h4 id="序列化源码解析"><a href="#序列化源码解析" class="header-anchor">#</a> 序列化源码解析</h4> <ul><li><p>**步骤一：**代码分析</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserInfoSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    group <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'gp'</span><span class="token punctuation">,</span>
    											lookup_field<span class="token operator">=</span><span class="token string">'group_id'</span><span class="token punctuation">,</span>
    											lookup_url_kwarg<span class="token operator">=</span><span class="token string">'pk'</span><span class="token punctuation">)</span>  
    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        <span class="token comment"># fields = '__all__'</span>
        fields <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'username'</span><span class="token punctuation">,</span> <span class="token string">'password'</span><span class="token punctuation">,</span> <span class="token string">'group'</span><span class="token punctuation">,</span> <span class="token string">'roles'</span><span class="token punctuation">]</span>
        depth <span class="token operator">=</span> <span class="token number">0</span>
        
<span class="token keyword">class</span> <span class="token class-name">UserinfoView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>   
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        users <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> UserInfoSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>users<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'request'</span><span class="token punctuation">:</span>request<span class="token punctuation">}</span><span class="token punctuation">)</span> 
        

        ret <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
    
  <span class="token comment"># 以上述视图类为例子：</span>
<span class="token number">1</span>、url路径匹配带CBV，再get中对UserInfoSeriazer进行实例化，去该类中找构造函数init，所以往上走 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> ModelSerializer类，任然没有，再往上走 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> Serializer类<span class="token punctuation">,</span>没有 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> BaseSerializer中找到__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>，同时还有__new__方法，且先执行new方法，进行判断many参数
	    <span class="token keyword">def</span> <span class="token function">__new__</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> kwargs<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'many'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 分析是否是一个Queryst列表</span>
                <span class="token keyword">return</span> cls<span class="token punctuation">.</span>many_init<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__new__<span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  <span class="token comment"># 对单个对象进行处理，从Field那获取空间self，然后执行自己的init方法</span>
        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> data<span class="token operator">=</span>empty<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>instance <span class="token operator">=</span> instance   <span class="token comment"># 传入的单个对象</span>
            <span class="token keyword">if</span> data <span class="token keyword">is</span> <span class="token keyword">not</span> empty<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>initial_data <span class="token operator">=</span> data
            self<span class="token punctuation">.</span>partial <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'partial'</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>_context <span class="token operator">=</span> kwargs<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'context'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 传入参数</span>
            kwargs<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'many'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
            <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>

<span class="token number">2</span>、打开many_init<span class="token punctuation">(</span><span class="token punctuation">)</span>函数，里面返回了
		<span class="token keyword">def</span> <span class="token function">many_init</span><span class="token punctuation">(</span>cls<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        	list_serializer_class <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>meta<span class="token punctuation">,</span> <span class="token string">'list_serializer_class'</span><span class="token punctuation">,</span> ListSerializer<span class="token punctuation">)</span>
            <span class="token comment">#调用ListSeralizer进行处理</span>
        	<span class="token keyword">return</span> list_serializer_class<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>list_kwargs<span class="token punctuation">)</span>
        
<span class="token number">3</span>、回到序列化后我们调用，ser<span class="token punctuation">.</span>data<span class="token punctuation">,</span>点击查看源码
	<span class="token number">3.1</span> @<span class="token builtin">property</span>
        <span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            ret <span class="token operator">=</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data  <span class="token comment"># 调用了BaseSerializer中的data属性</span>
            <span class="token keyword">return</span> ReturnDict<span class="token punctuation">(</span>ret<span class="token punctuation">,</span> serializer<span class="token operator">=</span>self<span class="token punctuation">)</span>  <span class="token comment"># 返回一个有序字典</span>
    <span class="token number">3.2</span>、打开父类的data属性：（用于对_data进行返回）
    	<span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    	  <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'_data'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>instance <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token keyword">not</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">'_errors'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
                <span class="token comment"># 我们再去choices时使用过to_repersentions,用于获取对象中的值</span>
                self<span class="token punctuation">.</span>_data <span class="token operator">=</span> self<span class="token punctuation">.</span>to_representation<span class="token punctuation">(</span>self<span class="token punctuation">.</span>instance<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
           <span class="token keyword">return</span> self<span class="token punctuation">.</span>_data
    
    <span class="token number">3.3</span>、查找自己的self<span class="token punctuation">.</span>to_representation方法，顶层是一个抛异常，最终我们在Serializer中找到了
    	 <span class="token keyword">def</span> <span class="token function">to_representation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Object instance -&gt; Dict of primitive datatypes.
            &quot;&quot;&quot;</span>
            ret <span class="token operator">=</span> OrderedDict<span class="token punctuation">(</span><span class="token punctuation">)</span>
            fields <span class="token operator">=</span> self<span class="token punctuation">.</span>_readable_fields <span class="token comment"># 可读字段，进行了过滤了字段</span>

            <span class="token keyword">for</span> field <span class="token keyword">in</span> fields<span class="token punctuation">:</span> <span class="token comment"># 对我们自定义的所有字段，循环</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>
                    <span class="token comment"># 调用CharField.get_attribute方法，instance就是我们传入的对象</span>
                    attribute <span class="token operator">=</span> field<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span>instance<span class="token punctuation">)</span>
                <span class="token keyword">except</span> SkipField<span class="token punctuation">:</span>
                    <span class="token keyword">continue</span>
              check_for_none <span class="token operator">=</span> attribute<span class="token punctuation">.</span>pk <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>attribute<span class="token punctuation">,</span> PKOnlyObject<span class="token punctuation">)</span> 
            															<span class="token keyword">else</span> attribute
            <span class="token keyword">if</span> check_for_none <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                ret<span class="token punctuation">[</span>field<span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ret<span class="token punctuation">[</span>field<span class="token punctuation">.</span>field_name<span class="token punctuation">]</span> <span class="token operator">=</span> field<span class="token punctuation">.</span>to_representation<span class="token punctuation">(</span>attribute<span class="token punctuation">)</span>
        <span class="token keyword">return</span> ret
    
    <span class="token number">3.4</span>、找到父父父类Field中的get_attrbute<span class="token punctuation">(</span>self<span class="token punctuation">,</span>instance<span class="token punctuation">)</span>
    	 <span class="token keyword">def</span> <span class="token function">get_attribute</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> instance<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token triple-quoted-string string">&quot;&quot;&quot;
            Given the *outgoing* object instance, return the primitive value
            that should be used for this field.
            &quot;&quot;&quot;</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> get_attribute<span class="token punctuation">(</span>instance<span class="token punctuation">,</span> self<span class="token punctuation">.</span>source_attrs<span class="token punctuation">)</span> <span class="token comment"># 这里的source就是我们传入的source进行切割的列表，如'group.id'-&gt;[group,id], 我们再点开get_attrbute方法</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token number">3.5</span>、在进入更内层的get_attribute<span class="token punctuation">(</span><span class="token punctuation">)</span>
    	  <span class="token keyword">def</span> <span class="token function">get_attribute</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token triple-quoted-string string">&quot;&quot;&quot;
                Similar to Python's built in `getattr(instance, attr)`,
                but takes a list of nested attributes, instead of a single attribute.
                Also accepts either attribute lookup on objects or dictionary lookups.
                &quot;&quot;&quot;</span>
                <span class="token comment"># 循环传入的source列表[group,title],或则['get_user_type_display']</span>
                <span class="token keyword">for</span> attr <span class="token keyword">in</span> attrs<span class="token punctuation">:</span>
                    <span class="token keyword">try</span><span class="token punctuation">:</span>
                        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> Mapping<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            instance <span class="token operator">=</span> instance<span class="token punctuation">[</span>attr<span class="token punctuation">]</span>
                        <span class="token keyword">else</span><span class="token punctuation">:</span>
                            instance <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> attr<span class="token punctuation">)</span> <span class="token comment"># 拿到一个对象字段，给instance</span>
                    <span class="token keyword">except</span> ObjectDoesNotExist<span class="token punctuation">:</span>
                        <span class="token keyword">return</span> <span class="token boolean">None</span>
                    <span class="token keyword">if</span> is_simple_callable<span class="token punctuation">(</span>instance<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 判断是否是可以调用的如get_user_type_display</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                            instance <span class="token operator">=</span> instance<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 执行函数</span>
                 	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
                <span class="token keyword">return</span> instance
</code></pre></div><ul><li><h5 id="小提示-4"><a href="#小提示-4" class="header-anchor">#</a> 小提示：</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token number">1</span>、 many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>将QuerySet列表交给ListSerializer处理
	many<span class="token operator">=</span><span class="token boolean">False</span> <span class="token punctuation">,</span>将对象交给Serliazer处理

<span class="token number">2</span>、单个对象：self<span class="token punctuation">.</span>to_representation
   Queryset时：self<span class="token punctuation">.</span>to_representation

</code></pre></div></li></ul></li></ul> <h4 id="序列化请求数据校验"><a href="#序列化请求数据校验" class="header-anchor">#</a> 序列化请求数据校验</h4> <ul><li><h5 id="简单的从请求体中获取数据-并打印出form中的数据校验"><a href="#简单的从请求体中获取数据-并打印出form中的数据校验" class="header-anchor">#</a> 简单的从请求体中获取数据，并打印出form中的数据校验</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserGroupSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    titile <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span><span class="token string">'标题不能为空'</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># 因为继承了Field，所以都有</span>
    
<span class="token keyword">class</span> <span class="token class-name">UserGourpView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># 必须再data之前使用，否则data后就没有body了，b'{\n&quot;name&quot;:&quot;alex&quot;\n}'</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment"># 已经配置了解析器 {'name': 'alex'}</span>
        ser <span class="token operator">=</span> UserGroupSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ser<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'提交数据'</span><span class="token punctuation">)</span>
  
 <span class="token comment"># url中</span>
urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
	<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    url<span class="token punctuation">(</span><span class="token string">r'(?P&lt;version&gt;[v1|v2]+)/usergroup/$'</span><span class="token punctuation">,</span>views<span class="token punctuation">.</span>UserGourpView<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

 <span class="token comment"># 运行结果</span>
 <span class="token punctuation">{</span><span class="token string">'titile'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>ErrorDetail<span class="token punctuation">(</span>string<span class="token operator">=</span><span class="token string">'标题不能为空'</span><span class="token punctuation">,</span> code<span class="token operator">=</span><span class="token string">'required'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><h5 id="自定义类进行内置校验器校验"><a href="#自定义类进行内置校验器校验" class="header-anchor">#</a> 自定义类进行内置校验器校验</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">XXXValidator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>base <span class="token operator">=</span> base  <span class="token comment"># 传入的参数</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 只要触犯实例化就会触发__call__方法</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> value<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>self<span class="token punctuation">.</span>base<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 必须以base开头</span>
            message <span class="token operator">=</span> <span class="token string">'标题必须以 %s 开头.'</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>base
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span>message<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">set_context</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer_field<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        This hook is called by the serializer instance,
        prior to the validation call being made.
        &quot;&quot;&quot;</span>
        <span class="token comment"># 执行验证之前调用,serializer_fields是当前字段对象</span>
        <span class="token keyword">pass</span>

<span class="token keyword">class</span> <span class="token class-name">UserGroupSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span><span class="token string">'标题不能为空'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    												validators<span class="token operator">=</span><span class="token punctuation">[</span>XXXValidator<span class="token punctuation">(</span><span class="token string">'中国'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
<span class="token keyword">class</span> <span class="token class-name">UserGourpView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># 必须再data之前使用，否则data后就没有body了，b'{\n&quot;name&quot;:&quot;alex&quot;\n}'</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment"># 已经配置了解析器 {'name': 'alex'}</span>
        ser <span class="token operator">=</span> UserGroupSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ser<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'提交数据'</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p><strong>补充：</strong></p> <div class="language-python extra-class"><pre class="language-python"><code>当然可以通过函数进行内置校验器校验：
<span class="token keyword">def</span>  <span class="token function">validate_title</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">'mjj'</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError
    
<span class="token keyword">class</span> <span class="token class-name">UserGroupSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span><span class="token string">'标题不能为空'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span>validate_title<span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li> <li><h5 id="序列化的局部校验-钩子函数"><a href="#序列化的局部校验-钩子函数" class="header-anchor">#</a> 序列化的局部校验(钩子函数)</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UserGroupSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span><span class="token string">'标题不能为空'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">validate_title</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># validate_字段名，用来局部验证，局部钩子</span>
        <span class="token keyword">if</span> <span class="token string">'mjj'</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError
        <span class="token keyword">return</span> value
    
<span class="token keyword">class</span> <span class="token class-name">UserGourpView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># 必须再data之前使用，否则data后就没有body了，b'{\n&quot;name&quot;:&quot;alex&quot;\n}'</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment"># 已经配置了解析器 {'name': 'alex'}</span>
        ser <span class="token operator">=</span> UserGroupSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ser<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'提交数据'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><h5 id="序列化的全局钩子"><a href="#序列化的全局钩子" class="header-anchor">#</a> 序列化的全局钩子</h5> <div class="language-python extra-class"><pre class="language-python"><code>
<span class="token keyword">class</span> <span class="token class-name">UserGroupSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>Serializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>error_messages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'required'</span><span class="token punctuation">:</span><span class="token string">'标题不能为空'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>validators<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    
    <span class="token keyword">def</span> <span class="token function">validate_title</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># validate_字段名，用来局部验证</span>
        <span class="token keyword">if</span> <span class="token string">'mjj'</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError
        <span class="token keyword">return</span> value
    
    <span class="token keyword">def</span> <span class="token function">validate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>attrs<span class="token punctuation">)</span>  <span class="token comment"># OrderedDict([('title', 'mj')])</span>
        <span class="token keyword">if</span> attrs<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'666'</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError  <span class="token comment">#{'non_field_errors': [ErrorDetail(string='Invalid input.', code='invalid')]}</span>
        <span class="token keyword">return</span> attrs
    
<span class="token keyword">class</span> <span class="token class-name">UserGourpView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>body<span class="token punctuation">)</span>  <span class="token comment"># 必须再data之前使用，否则data后就没有body了，b'{\n&quot;name&quot;:&quot;alex&quot;\n}'</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment"># 已经配置了解析器 {'name': 'alex'}</span>
        ser <span class="token operator">=</span> UserGroupSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ser<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'提交数据'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><h5 id="使用extra-kwargs进行每个字段的扩展"><a href="#使用extra-kwargs进行每个字段的扩展" class="header-anchor">#</a> 使用extra_kwargs进行每个字段的扩展</h5> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">PasswordValidator</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>base <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__call__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> value <span class="token operator">!=</span> self<span class="token punctuation">.</span>base<span class="token punctuation">:</span>
            message <span class="token operator">=</span> <span class="token string">'This field must be %s.'</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>base
            <span class="token keyword">raise</span> serializers<span class="token punctuation">.</span>ValidationError<span class="token punctuation">(</span>message<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">set_context</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> serializer_field<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">&quot;&quot;&quot;
        This hook is called by the serializer instance,
        prior to the validation call being made.
        &quot;&quot;&quot;</span>
        <span class="token comment"># 执行验证之前调用,serializer_fields是当前字段对象</span>
        <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">ModelUserSerializer</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>HyperlinkedModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ll <span class="token operator">=</span> serializers<span class="token punctuation">.</span>HyperlinkedIdentityField<span class="token punctuation">(</span>view_name<span class="token operator">=</span><span class="token string">'xxxx'</span><span class="token punctuation">)</span>
    tt <span class="token operator">=</span> serializers<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo
        fields <span class="token operator">=</span> <span class="token string">&quot;__all__&quot;</span>
        list_serializer_class <span class="token operator">=</span> serializers<span class="token punctuation">.</span>ListSerializer

        extra_kwargs <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment"># 可以对每个字段进行配置，甚至read_only</span>
            <span class="token string">'user'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'min_length'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'pwd'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'validators'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>PasswordValidator<span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'url'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'view_name'</span><span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'ut'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'view_name'</span><span class="token punctuation">:</span> <span class="token string">'xxxx'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>


<span class="token keyword">class</span> <span class="token class-name">TestView</span><span class="token punctuation">(</span>APIView<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># # 序列化，将数据库查询字段序列化为字典</span>
        data_list <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        ser <span class="token operator">=</span> ModelUserSerializer<span class="token punctuation">(</span>instance<span class="token operator">=</span>data_list<span class="token punctuation">,</span> many<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'request'</span><span class="token punctuation">:</span> request<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>ser<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 验证，对请求发来的数据进行验证</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        ser <span class="token operator">=</span> ModelUserSerializer<span class="token punctuation">(</span>data<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span> ser<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>validated_data<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>ser<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">'POST请求，响应内容'</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/python/django/REST framework之路由和渲染器.html" class="prev">
        REST framework之路由和渲染器
      </a></span> <span class="next"><a href="/python/django/REST framework版本图书管理系统.html">
        REST framework版本图书管理系统
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.51f2f156.js" defer></script><script src="/assets/js/2.8911ec45.js" defer></script><script src="/assets/js/47.f3990404.js" defer></script>
  </body>
</html>
